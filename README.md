Low-level Yubikey OTP decryption / verification library for node.js

# Install

	npm install yubikeyotp

# Usage

```javascript
var yubikeyotp = require('yubikeyotp');

// hex-encoded AES key
var aeskey = 'e6cdae77f55ac1db4acd3b7fd8151334';

// modhex-encoded OTP key generated by Yubikey programmed with above key
var otp = 'khdnrutkdendbrbghdjcidkhveuhbrcuublkdjfttcrk';

// result contents documented below
var result = yubikeyotp.parseOTP(otp, aeskey);

console.log(result);
```

Output:

```javascript
{ pubUid: '962bced923b2',
  uid: '4e8308389518',
  useCtr: 7,
  tstp: 1768874,
  sessionCtr: 0,
  rnd: 199,
  crc: 50219 }
```

# Documentation

`parseOTP` decrypts OTP using given AES key and returns `false` when the OTP is malformed or computed CRC16 does not match. Otherwise object with following properties is returned:

- `pubUid`: hex-encoded public UID (it is part of OTP string)
- `uid`: hex-encoded private UID (programmed on key along with AES key)
- `useCtr`: 15-bit boot counter - number of times Yubikey device was booted (inserted into USB port) since last reconfiguration
- `tstp`: 24-bit timer counting at approximately 8 Hz since last device boot (initialized randomly at boot)
- `sessionCtr`: 8-bit usage counter since last boot (bumps `useCtr` when overflowing)
- `rnd`: 16-bit random number
- `crc`: 16-bit CRC checksum (already verified by `parseOTP` method)

# Resources

- [YubiKey Technical Manual](http://www.yubico.com/wp-content/uploads/2013/07/YubiKey-Manual-v3_1.pdf)
